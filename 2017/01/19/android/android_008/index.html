<!DOCTYPE html>
<html lang="zh">
    <head>
    <!-- 
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.0 -->

    <!-- Title -->
    
    <title>
        
            Android学习笔记 008 | 
        
        Mr.Metro
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/fav.jpg">
    <link rel="icon" sizes="192x192" href="/img/fav.jpg">
    <link rel="apple-touch-icon" href="/img/fav.jpg">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="miccall">
    <meta name="description" content="Blog of miccall is records about my work">
    <meta name="keywords" content="miccall,android">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Mr.Metro">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://miccall.tech">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Android学习笔记 008 | Mr.Metro">
    <meta property="og:description" content="Blog of miccall is records about my work">
    <meta property="og:article:tag" content="android"> 

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #7EC0EE !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #7EC0EE !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #7EC0EE !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }
</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>



    <script src="/js/jquery.min.js"></script>
    <script src="/js/queue.js"></script>

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    

    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Android学习笔记"><span class="post-toc-number">1.</span> <span class="post-toc-text"> Android学习笔记 </span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').css('background-image', 'url(' + '/img/random/material-' + randomNum + '.png' + ')');
</script>

        
    
            <p class="article-headline-p">
                Android学习笔记 008
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/BA201701210404530018-00-000000.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>miccall</strong>
        <span>1月 19, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">devices other</i>
            <span class="visuallyhidden">devices other</span>
        </button>
        <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
            <li class="mdl-menu__item">在其它设备中阅读本文章</li>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACYUlEQVR42u3aQXbCMAwFwNz/0u0B2qZfsq0Ab7xiQUDDQjbfur4+el14eHh4eHh4eHgvxrvi9fOpXz46eP/9sxtqw8PDwxvh/dNqg/ckZeWkldrw8PDwJnl/FVR9nTT6+42kVxseHh7eK/Oqx+77Ft/7Xjw8PLz35VWPyHufxcPDw3uWl/zh77X7KvWxrAUPDw8v5uWXTPOvR+/38PDw8AJedeUNPTr+Fq+7ogrx8PDwDvN6Ee39s/nGk1+PJfXg4eHhzfDyIHVlCKAXbeQ/AR4eHt4kLyk0aff3rbx6NM8j4Gjfw8PDw9vKW4kGeqNXOWzD6AAeHh7eMV51G6he+ectvgrDw8PDm+etDDz1YIVCW0d2PDw8vEleb0uoXnHlW0XOxsPDw3uKl49V9YKDlafyazY8PDy8GV613ectPgdXw4jy6AAeHh7eMV5SbhIiVAOLahiBh4eH9ywv/+Ik9s0P5dUxhYNZCx4eHl7My1v8Sjibxxl5hIGHh4f3LK/a9HNevrVs22bw8PDwDvPyuLbX1ntjWEs/Nx4eHt4ILw8gqvik0N6hfMPQFR4eHt4yr7ox5O17/RDfDCPw8PDwDvPyrSJfeUS7Euzi4eHhTfJWys3bfbXo/ICOh4eHN8+74pWD1wf686u1DRdgeHh4eC1e9SK/F8LmAfHKMAEeHh7eJC+5/u+Nq+ajV/kWhYeHh/eOvHzEKimxN/aKh4eH9y68Xil5kFHdTvDw8PCe4lVHo6rhRX6dthQr4+Hh4Y3wehFAb4gqCSCiuPbE/R4eHh5ewPu8hYeHh4eHh4eH9wLrG/Wm7Tl842/wAAAAAElFTkSuQmCC">
        </ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/android/">android</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Android学习笔记 008&url=http://miccall.tech//2017/01/19/android/android_008/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Android学习笔记 008&url=http://miccall.tech//2017/01/19/android/android_008/index.html&via=miccall" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://miccall.tech//2017/01/19/android/android_008/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Mr.Metro&title=Android学习笔记 008&summary=Blog of miccall is records about my work&pics=http://miccall.tech/img/fav.jpg&url=http://miccall.tech/2017/01/19/android/android_008/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <hr>
<h1 id="Android学习笔记"><a href="#Android学习笔记" class="headerlink" title=" Android学习笔记 "></a><strong> Android学习笔记 </strong></h1><p>#设置外拨电话和来电界面toast的位置#</p>
<pre><code>1.在设置归属地提示框位置界面中保存控件移动到的新的位置的坐标,在up事件中
    case MotionEvent.ACTION_UP:
                //抬起的事件
                System.out.println(&quot;抬起了....&quot;);
                //保存控件的坐标,保存的是控件的坐标不是手指坐标
                //获取控件的坐标
                int x = ll_dragview_toast.getLeft();
                int y = ll_dragview_toast.getTop();

                Editor edit = sp.edit();
                edit.putInt(&quot;x&quot;, x);
                edit.putInt(&quot;y&quot;, y);
                edit.commit();
                break;
2.在addressservice中的showToast方法中,根据保存的坐标设置toast的位置
     params.x = sp.getInt(&quot;x&quot;, 100);//不是坐标,表示的距离边框的距离,根据gravity来设置的,如果gravity是left表示距离左边框的距离,如果是right表示距离有边框的距离
     params.y = sp.getInt(&quot;y&quot;, 100);//跟x的含义
</code></pre><p>#位置回显操作# (重点:layoutparams)</p>
<pre><code>控制正常显示出来
    1.测量控件的宽高
    2.分配控件的位置   
    3.绘制控件

回显操作
    //设置控件回显操作
    //1.获取保存的坐标
    int x = sp.getInt(&quot;x&quot;, 0);
    int y = sp.getInt(&quot;y&quot;, 0);
    System.out.println(&quot;x:&quot;+x+&quot; y:&quot;+y);
    //2.重新绘制控件
    /*int width = ll_dragview_toast.getWidth();
    int height = ll_dragview_toast.getHeight();
    System.out.println(&quot;width:&quot;+width+&quot; height:&quot;+height);
    ll_dragview_toast.layout(x, y, x+width, y+height);*/
    //在初始化控件之前重新设置控件的属性
    //2.1获取父控件的属性规则,父控件的layoutparams
    RelativeLayout.LayoutParams params = (LayoutParams) ll_dragview_toast.getLayoutParams();
    //2.2设置相应的属性
    //leftMargin : 距离父控件左边的距离,根据布局文件中控件中layout_marginLeft属性效果相似
    params.leftMargin = x;
    params.topMargin = y;
    //2.3给控件设置属性
    ll_dragview_toast.setLayoutParams(params);
</code></pre><p>#防止控件移出屏幕的操作#</p>
<pre><code>在move事件中,在绘制控件之前判断
    //在绘制控件之前,判断ltrb的值是否超出屏幕的大小,如果是就不在进行绘制控件的操作
    if (l &lt; 0 || r &gt; width || t &lt; 0 || b &gt; height - 25) {
        break;
    }
</code></pre><p>#触摸事件和点击的冲突问题#</p>
<pre><code>点击事件 : 一组事件的集合,按下+抬起
触摸事件 : 每个事件都是一个单独的事件,按下,移动,抬起

如果只有触摸事件:return true表示事件执行
如果点击事件和触摸事件共同存在,触摸事件的事件是会点击事件消费掉

先执行触摸   然后执行其他事件

点击 按下+抬起

return false
触摸 :  按下 执行完  -&gt;  移动  执行完 -&gt; 抬起 
触摸+点击 :   按下(触摸) 拦截 - &gt; 按下(点击) 执行 - &gt; 抬起(触摸) 拦截 - &gt; 抬起(点击) 执行 - &gt; 输出(触摸) - &gt; 输出(点击)

return true

触摸 : 按下 -&gt; 移动 -&gt; 抬起
触摸+点击  按下(触摸) 执行 -&gt;  移动(触摸) -&gt; 抬起(触摸)


如果只有触摸事件:return true;
如果触摸+点击事件:触摸事件return false
</code></pre><p>#双击居中# (重点)</p>
<pre><code>long[] mHits = new long[2];
/**
 * 双击居中
 */
private void setDoubleClick() {
    ll_dragview_toast.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            /**
             *  src the source array to copy the content.   拷贝的原数组
                srcPos the starting index of the content in src.  是从源数组那个位置开始拷贝
                dst the destination array to copy the data into.  拷贝的目标数组
                dstPos the starting index for the copied content in dst.  是从目标数组那个位置开始去写
                length the number of elements to be copied.   拷贝的长度
             */
            //拷贝数组操作
            System.arraycopy(mHits, 1, mHits, 0, mHits.length-1);
            mHits[mHits.length-1] = SystemClock.uptimeMillis();  // 将离开机的时间设置给数组的第二个元素,离开机时间 :毫秒值,手机休眠不算
            if (mHits[0] &gt;= (SystemClock.uptimeMillis()-500)) {  // 判断是否多击操作
                System.out.println(&quot;双击了...&quot;);
                //双击居中
                int l = (width - ll_dragview_toast.getWidth())/2;
                int t = (height -25- ll_dragview_toast.getHeight())/2;
                ll_dragview_toast.layout(l, t, l+ll_dragview_toast.getWidth(), t+ll_dragview_toast.getHeight());
                //保存控件的坐标
                Editor edit = sp.edit();
                edit.putInt(&quot;x&quot;, l);
                edit.putInt(&quot;y&quot;, t);
                edit.commit();
            }
        }
    });
}
</code></pre><p>#细节的处理#</p>
<pre><code>1.在布局文件中添加两个一模一样的textview,一个在上方,一个在下方
2.在move事件根据控件距离顶部的距离判断隐藏显示
                //判断textview的隐藏显示
                int top = ll_dragview_toast.getTop();
                if (top &gt;= height/2) {
                    //隐藏下方显示上方
                    tv_dragview_bottom.setVisibility(View.INVISIBLE);
                    tv_dragview_top.setVisibility(View.VISIBLE);
                }else{
                    //隐藏上方显示下方
                    tv_dragview_top.setVisibility(View.INVISIBLE);
                    tv_dragview_bottom.setVisibility(View.VISIBLE);
                }
3.在回显操作的时候也进行相应的判断
        if (y &gt;= height/2) {
            //隐藏下方显示上方
            tv_dragview_bottom.setVisibility(View.INVISIBLE);
            tv_dragview_top.setVisibility(View.VISIBLE);
        }else{
            //隐藏上方显示下方
            tv_dragview_top.setVisibility(View.INVISIBLE);
            tv_dragview_bottom.setVisibility(View.VISIBLE);
        }
</code></pre><p>#外拨电话和来电显示界面toast的拖动#  (重点:触摸监听事件)</p>
<pre><code>1.给toast设置触摸监听事件
    /**
     * toast触摸监听事件
     */
    private void setTouch() {
        view.setOnTouchListener(new OnTouchListener() {
            private int startX;
            private int startY;

            //v : 当前的控件
            //event : 控件执行的事件
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                //event.getAction() : 获取控制的执行的事件
                switch (event.getAction()) {
                case MotionEvent.ACTION_DOWN:
                    //按下的事件
                    System.out.println(&quot;按下了....&quot;);
                    //1.按下控件,记录开始的x和y的坐标
                    startX = (int) event.getRawX();
                    startY = (int) event.getRawY();
                    break;
                case MotionEvent.ACTION_MOVE:
                    //移动的事件
                    System.out.println(&quot;移动了....&quot;);
                    //2.移动到新的位置记录新的位置的x和y的坐标
                    int newX = (int) event.getRawX();
                    int newY = (int) event.getRawY();
                    //3.计算移动的偏移量
                    int dX = newX-startX;
                    int dY = newY-startY;
                    //4.移动相应的偏移量,重新绘制控件
                    params.x+=dX;
                    params.y+=dY;
                    //控制控件的坐标不能移出外拨电话界面
                    if (params.x &lt; 0) {
                        params.x = 0;
                    }
                    if (params.y &lt; 0) {
                        params.y=0;
                    }
                    if (params.x &gt; width-view.getWidth()) {
                        params.x = width-view.getWidth();
                    }
                    if (params.y &gt; height - view.getHeight() - 25) {
                        params.y = height - view.getHeight() - 25;
                    }

                    windowManager.updateViewLayout(view, params);//更新windowmanager中的控件
                    //5.更新开始的坐标
                    startX=newX;
                    startY=newY;
                    break;
                case MotionEvent.ACTION_UP:
                    //抬起的事件
                    System.out.println(&quot;抬起了....&quot;);
                    //保存控件的坐标,保存的是控件的坐标不是手指坐标
                    //获取控件的坐标
                    int x = params.x;
                    int y = params.y;

                    Editor edit = sp.edit();
                    edit.putInt(&quot;x&quot;, x);
                    edit.putInt(&quot;y&quot;, y);
                    edit.commit();
                    break;
                }
                //True if the listener has consumed the event, false otherwise.
                //true:事件消费了,执行了,false:表示事件被拦截了
                return false;
            }
        });
    }
2.修改相应的属性
    params.flags = WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE // 没有焦点
            |
            // WindowManager.LayoutParams.FLAG_NOT_TOUCHABLE // 不可触摸
            // |
            WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON; // 保持当前屏幕
    params.format = PixelFormat.TRANSLUCENT; // 透明
    params.type = WindowManager.LayoutParams.TYPE_PRIORITY_PHONE; // 使用TYPE_PHONE//// 执行toast的类型,toast天生是没有获取见到和触摸事件
3.权限
     &lt;uses-permission android:name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;/&gt;
</code></pre><p>#小火箭#</p>
<pre><code>10-15 06:18:10.301: E/AndroidRuntime(15436): android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?  //没有给activity设置任务栈

1.触摸监听事件
    /**
     * 小火箭设置触摸监听事件
     */
    private void setTouch() {
        view.setOnTouchListener(new OnTouchListener() {
            private int startX;
            private int startY;

            //v : 当前的控件
            //event : 控件执行的事件
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                //event.getAction() : 获取控制的执行的事件
                switch (event.getAction()) {
                case MotionEvent.ACTION_DOWN:
                    //按下的事件
                    System.out.println(&quot;按下了....&quot;);
                    //1.按下控件,记录开始的x和y的坐标
                    startX = (int) event.getRawX();
                    startY = (int) event.getRawY();
                    break;
                case MotionEvent.ACTION_MOVE:
                    //移动的事件
                    System.out.println(&quot;移动了....&quot;);
                    //2.移动到新的位置记录新的位置的x和y的坐标
                    int newX = (int) event.getRawX();
                    int newY = (int) event.getRawY();
                    //3.计算移动的偏移量
                    int dX = newX-startX;
                    int dY = newY-startY;
                    //4.移动相应的偏移量,重新绘制控件
                    params.x+=dX;
                    params.y+=dY;
                    //控制控件的坐标不能移出外拨电话界面
                    if (params.x &lt; 0) {
                        params.x = 0;
                    }
                    if (params.y &lt; 0) {
                        params.y=0;
                    }
                    if (params.x &gt; width-view.getWidth()) {
                        params.x = width-view.getWidth();
                    }
                    if (params.y &gt; height - view.getHeight() - 25) {
                        params.y = height - view.getHeight() - 25;
                    }

                    windowManager.updateViewLayout(view, params);//更新windowmanager中的控件
                    //5.更新开始的坐标
                    startX=newX;
                    startY=newY;
                    break;
                case MotionEvent.ACTION_UP:
                    //抬起的事件
                    System.out.println(&quot;抬起了....&quot;);
                    //发射小火箭
                    //判断小火箭是否在屏幕底部中间的位置,在就可以发送,不在不能发送
                    if (params.y &gt; 290 &amp;&amp; params.x &gt; 100 &amp;&amp; params.x &lt; 200) {
                        sendRocket();

                        //开启烟雾动画
                        Intent intent = new Intent(RocketService.this,BackGroundActivity.class);
                        //给跳转了activity设置任务栈
                        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                        startActivity(intent);
                    }
                    break;
                }
                //True if the listener has consumed the event, false otherwise.
                //true:事件消费了,执行了,false:表示事件被拦截了
                return true;
            }
        });
    }
2.帧动画
    a.res -&gt; anim - &gt; xxx.xml
        &lt;animation-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
            android:oneshot=&quot;false&quot;&gt; &lt;!-- oneshot : 是否执行一次    true:执行一次   false:循环执行 --&gt;
            &lt;item android:drawable=&quot;@drawable/desktop_rocket_launch_1&quot; android:duration=&quot;200&quot; /&gt;
            &lt;item android:drawable=&quot;@drawable/desktop_rocket_launch_2&quot; android:duration=&quot;200&quot; /&gt;
        &lt;/animation-list&gt;
    b.使用
        AnimationDrawable animationDrawable = (AnimationDrawable) iv_rocket.getBackground();
        animationDrawable.start();//开始动画
3.渐变动画
    AlphaAnimation alphaAnimation = new AlphaAnimation(0, 1);
    alphaAnimation.setDuration(200);
    ImageView smoke_m = (ImageView) findViewById(R.id.smoke_m);
    ImageView smoke_t = (ImageView) findViewById(R.id.smoke_t);

    //执行动画
    smoke_m.startAnimation(alphaAnimation);
    smoke_t.startAnimation(alphaAnimation);
</code></pre><p>#创建数据库# (重点)</p>
<pre><code>1.创建一个类继承SQLiteOpenHelper
    //创建数据库
    public class BlackNumOpenHlper extends SQLiteOpenHelper {
        //方便后期我们在实现数据库操作的时候能方便去使用表名,同时也方便后期去修改表名
        private static final String DB_NAME=&quot;info&quot;;
        /**
         * context : 上下文
         * name :　数据库名称
         * factory：游标工厂
         * version : 数据库的版本号
         * @param context
         */
        public BlackNumOpenHlper(Context context) {
            super(context, &quot;blacknum.db&quot;, null, 1);
        }
        //第一次创建数据库的调用,创建表结构
        @Override
        public void onCreate(SQLiteDatabase db) {
            //创建表结构   字段:   blacknum:黑名单号码     mode:拦截类型
            //参数:创建表结构sql语句
            db.execSQL(&quot;create table &quot;+DB_NAME+&quot;(_id integer primary key autoincrement,blacknum varchar(20),mode varchar(2))&quot;);
        }
        //当数据库版本发生变化的时候调用
        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        }

    }
2.单元测试
    public void testBlackNumOpenHelper(){
        BlackNumOpenHlper blackNumOpenHlper = new BlackNumOpenHlper(getContext());//不能创建数据库
        blackNumOpenHlper.getReadableDatabase();//创建数据库
    }
</code></pre><p>#添加黑名单# (重点)</p>
<pre><code>/**
 * 添加黑名单
 * @param blacknum
 * @param mode
 */
public void addBlackNum(String blacknum,int mode){
    //1.获取数据库
    SQLiteDatabase database = blackNumOpenHlper.getWritableDatabase();
    //2.添加操作
    //ContentValues :　添加的数据
    ContentValues values = new ContentValues();
    values.put(&quot;blacknum&quot;, blacknum);
    values.put(&quot;mode&quot;, mode);
    database.insert(BlackNumOpenHlper.DB_NAME, null, values);
    //3.关闭数据库
    database.close();
}
</code></pre><p>#数据其他操作# (重点)<br>    1.更新<br>        /**</p>
<pre><code>     * 更新黑名单的拦截模式
     */
    public void updateBlackNum(String blacknum,int mode){
        //1.获取数据库
        SQLiteDatabase database = blackNumOpenHlper.getWritableDatabase();
        //2.更新操作
        ContentValues values = new ContentValues();
        values.put(&quot;mode&quot;, mode);
        //table : 表名
        //values : 要更新数据
        //whereClause : 查询条件  where blacknum=blacknum
        //whereArgs : 查询条件的参数
        database.update(BlackNumOpenHlper.DB_NAME, values, &quot;blacknum=?&quot;, new String[]{blacknum});
        //3.关闭数据库
        database.close();
    }
2.查询
    /**
     * 通过黑名单号码,查询黑名单号码的拦截模式
     */
    public int queryBlackNumMode(String blacknum){
        int mode=-1;
        //1.获取数据库
        SQLiteDatabase database = blackNumOpenHlper.getReadableDatabase();
        //2.查询数据库
        //table : 表名
        //columns : 查询的字段  mode
        //selection : 查询条件  where xxxx = xxxx
        //selectionArgs : 查询条件的参数
        //groupBy : 分组
        //having : 去重
        //orderBy : 排序
        Cursor cursor = database.query(BlackNumOpenHlper.DB_NAME, new String[]{&quot;mode&quot;}, &quot;blacknum=?&quot;, new String[]{blacknum}, null, null, null);
        //3.解析cursor
        if (cursor.moveToNext()) {
            //获取查询出来的数据
            mode = cursor.getInt(0);
        }
        //4.关闭数据库
        cursor.close();
        database.close();
        return mode;
    }
3.删除
    /**
     * 根据黑名单号码,删除相应的数据
     * @param blacknum
     */
    public void deleteBlackNum(String blacknum){
        //1.获取数据库
        SQLiteDatabase database = blackNumOpenHlper.getWritableDatabase();
        //2.删除
        //table : 表名
        //whereClause : 查询的条件
        //whereArgs : 查询条件的参数
        database.delete(BlackNumOpenHlper.DB_NAME, &quot;blacknum=?&quot;, new String[]{blacknum});
        //3.关闭数据库
        database.close();
    }
</code></pre>
    

    
</div>


                

                <!-- Post Comments -->
                
                    




    <!-- 使用 DISQUS_CLICK -->
    <div id="disqus-comment">	
        <div id="disqus_thread"></div>
<!-- include js -->
<script src="/js/ripple.js"></script>

<!-- add animation -->
<style>
        .ripple-container {
        }
        .ripple-container .ripple{
            background-color: rgba(255,255,255,0.4);
            animation: ripple 2s forwards cubic-bezier(0, 0, 0.2, 1);
        }
        @keyframes ripple {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            80% {
                transform: scale(1);
            }
            100% {
                opacity: 0;
            }
        }
		.disqus_click_btn {
            background-color: dodgerblue;
            color: white;
            padding: 10px 20px;
            border:0;
            font-size: 14px;
            cursor: pointer
        }
</style>
	
<!-- add data-ripple attribute -->
<div class="btn_click_load"> 
    <button class="disqus_click_btn" data-ripple>阅读评论 「请确保 disq.us &amp; disquscdn.com &amp; disqus.com 可以正常加载」</button>
</div>
	
<script>
    // add effect to elements
    Array.prototype.forEach.call(document.querySelectorAll('[data-ripple]'), function(element){
        // find all elements and attach effect
        new RippleEffect(element); // element is instance of javascript element node
    });
</script>

<script>
    $('.btn_click_load').click(function() {  //click to load comments
        var disqus_config = function () {
            this.page.url = 'http://miccall.tech/2017/01/19/android/android_008/index.html';  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//http-miccall-tech.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
  	

    </div>
    <style>
        #disqus-comment{
            background-color: #eee;
            padding: 2pc;
        }
    </style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/01/19/android/android_009/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/01/19/android/android_007/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/preview.gif);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/BA201701210404530018-00-000000.png" alt="miccall's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        316459829@qq.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:316459829@qq.com.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
                <li>
                    <a href="http://shang.qq.com/email/stop/email_stop.html?qq=316459829&amp;sig=a1c657365db7e82805ea4b2351081fc3ebcde159f8ae49b1&amp;tttt=1" target="_blank" title="腾讯 QQ">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">phone</i>
                        
                        腾讯 QQ
                    </a>
                </li>
            
                <li>
                    <a href="http://blog.csdn.net/qq_31411825" target="_blank" title="CSDN">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">user</i>
                        
                        CSDN
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">二月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">19</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about/" title="About Me">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About Me
            </a>
        </li>
        
    
        <li>
            <a href="/group/" title="About Group">
                
                    <i class="material-icons sidebar-material-icons">group</i>
                
                About Group
            </a>
        </li>
        
    
        <li>
            <a href="/gallery/" title="My Grally">
                
                    <i class="material-icons sidebar-material-icons">image</i>
                
                My Grally
            </a>
        </li>
        
    
        <li>
            <a href="/tag/" title="Tag">
                
                    <i class="material-icons sidebar-material-icons">expore</i>
                
                Tag
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;Mr.Metro
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/lazyload.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    <script src="/js/smoothscroll.js"></script>





    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>







<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
